<!DOCTYPE html>
<html lang="id" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kediri Tourism - Jelajahi Keindahan Kota Tahu</title>
    <meta name="description" content="Temukan keindahan wisata, kuliner, dan budaya Kota Kediri. Panduan lengkap untuk menjelajahi destinasi menarik dengan navigasi real-time.">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>

    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="./images/logo.jpg" alt="Logo Kediri Tourism" height="40" width="40">
                <span>Kediri Tourism</span>
            </a>
            
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="pages/wisata.html">Wisata</a></li>
                    <li class="nav-item"><a class="nav-link" href="pages/kuliner.html">Kuliner</a></li>
                    <li class="nav-item"><a class="nav-link" href="pages/budaya.html">Budaya</a></li>
                    <li class="nav-item"><a class="nav-link" href="pages/peta.html">Peta</a></li>
                </ul>
                
                <div class="d-flex align-items-center gap-2 mt-3 mt-lg-0">
                    <div class="real-time-clock me-3 d-none d-md-block">
                        <small class="text-muted" id="realTimeClock"></small>
                    </div>
                    <button class="btn btn-sm btn-outline-secondary" id="themeToggle">
                        <i class="bi bi-moon"></i>
                    </button>
                    <button class="btn btn-sm btn-primary" id="locationAccess">
                        <i class="bi bi-geo-alt"></i> <span class="d-none d-md-inline">Lokasi</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <section id="home" class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">Jelajahi Keindahan Kota Kediri</h1>
            <p class="hero-subtitle">Temukan pesona wisata, kuliner legendaris, dan budaya yang memukau di jantung Jawa Timur</p>
            
            <div class="search-container">
                <div class="search-wrapper">
                    <input type="text" placeholder="Cari destinasi, kuliner, atau tempat menarik..." id="searchInput">
                    <button type="button">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
                <div class="autocomplete-results" id="autocompleteResults"></div>
            </div>
            
            <div class="hero-cta">
                <button class="btn btn-primary btn-lg" onclick="window.location.href='pages/wisata.html'">
                    <i class="bi bi-compass"></i> Jelajahi Wisata
                </button>
                <button class="btn btn-outline-light btn-lg" onclick="window.location.href='pages/peta.html'">
                    <i class="bi bi-map"></i> Lihat Peta
                </button>
            </div>
        </div>
        
        <div class="location-info" id="locationInfo">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-4 mb-2 mb-md-0">
                        <h6><i class="bi bi-geo-alt-fill text-primary"></i> Lokasi Anda</h6>
                        <p id="currentLocation">Mendeteksi lokasi...</p>
                    </div>
                    <div class="col-md-4 text-center">
                        <h6><i class="bi bi-clock-fill text-primary"></i> Waktu Lokal</h6>
                        <p id="localTime">-</p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <h6><i class="bi bi-house-fill text-primary"></i> Masjid Terdekat</h6>
                        <small id="nearestMosque">Mencari...</small>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="quick-stats">
        <div class="container">
            <div class="row g-4">
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>50+</h3>
                        <p>Destinasi Wisata</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>100+</h3>
                        <p>Kuliner Khas</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>15+</h3>
                        <p>Budaya & Tradisi</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>24/7</h3>
                        <p>Navigasi Real-time</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="destinasi" class="section-padding scroll-reveal">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Destinasi Unggulan</h2>
                <p class="section-subtitle">Temukan tempat-tempat menarik yang wajib dikunjungi di Kediri</p>
            </div>
            
            <div class="row g-4" id="destinationsGrid"></div>
            
            <div class="text-center mt-5">
                <a href="pages/wisata.html" class="btn btn-outline-primary btn-lg">Lihat Semua Destinasi</a>
            </div>
        </div>
    </section>

    <section id="kuliner" class="section-padding bg-light scroll-reveal">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Kuliner Legendaris</h2>
                <p class="section-subtitle">Rasakan kelezatan kuliner khas Kediri yang mendunia</p>
            </div>
            
            <div class="row g-4" id="culinaryGrid"></div>
            
            <div class="text-center mt-5">
                <a href="pages/kuliner.html" class="btn btn-outline-primary btn-lg">Jelajahi Semua Kuliner</a>
            </div>
        </div>
    </section>

    <section id="budaya" class="section-padding scroll-reveal">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Budaya & Tradisi</h2>
                <p class="section-subtitle">Mengenal kekayaan budaya dan tradisi Kota Kediri</p>
            </div>
            
            <div class="row g-4" id="cultureGrid"></div>
        </div>
    </section>

    <section id="peta" class="section-padding bg-dark text-white scroll-reveal">
        <div class="container">
            <div class="row align-items-center g-5">
                <div class="col-lg-6">
                    <h2 class="mb-4">Peta Interaktif Kediri</h2>
                    <p class="mb-4">Jelajahi Kota Kediri dengan peta digital kami yang dilengkapi navigasi real-time, penanda destinasi, dan rute terbaik.</p>
                    <ul class="feature-list">
                        <li><i class="bi bi-check-circle-fill"></i> Navigasi real-time dengan GPS</li>
                        <li><i class="bi bi-check-circle-fill"></i> Penanda kategori wisata, kuliner, budaya</li>
                        <li><i class="bi bi-check-circle-fill"></i> Perhitungan jarak dan waktu tempuh</li>
                        <li><i class="bi bi-check-circle-fill"></i> Integrasi Street View</li>
                    </ul>
                    <button class="btn btn-primary btn-lg mt-4" onclick="window.location.href='pages/peta.html'">
                        <i class="bi bi-map"></i> Buka Peta Lengkap
                    </button>
                </div>
                <div class="col-lg-6">
                    <div class="map-preview" id="mapPreview">
                        <img src="./images/map-preview.jpg" alt="Map Preview" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section-padding scroll-reveal">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="card weather-card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-cloud-sun"></i> Cuaca Kediri</h5>
                        </div>
                        <div class="card-body" id="weatherInfo">
                            <div class="weather-info">
                                <div class="weather-icon">
                                    <i class="bi bi-thermometer-sun" id="weatherIcon"></i>
                                </div>
                                <div class="weather-details">
                                    <h3 id="currentTemp">-</h3>
                                    <p class="mb-1" id="weatherCondition">Memuat data cuaca...</p>
                                    <small class="text-muted">
                                        Kelembaban: <span id="humidity">-</span> | 
                                        Angin: <span id="windSpeed">-</span>
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card events-card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="bi bi-clock"></i> Jadwal Shalat Hari Ini</h5>
                            <small id="prayerDate">-</small>
                        </div>
                        <div class="card-body" id="prayerTimes">
                            <div class="prayer-times-grid">
                                <div class="prayer-time-item">
                                    <span class="prayer-name">Subuh</span>
                                    <span class="prayer-time" id="fajrTime">-</span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">Dzuhur</span>
                                    <span class="prayer-time" id="dhuhrTime">-</span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">Ashar</span>
                                    <span class="prayer-time" id="asrTime">-</span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">Maghrib</span>
                                    <span class="prayer-time" id="maghribTime">-</span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">Isya</span>
                                    <span class="prayer-time" id="ishaTime">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="newsletter-section scroll-reveal">
        <div class="container">
            <div class="row align-items-center g-4">
                <div class="col-lg-6">
                    <h3 class="text-white mb-3">Dapatkan Info Terbaru</h3>
                    <p class="text-white mb-0 opacity-75">Berlangganan newsletter untuk mendapatkan update destinasi, event, dan promo terbaru di Kediri.</p>
                </div>
                <div class="col-lg-6">
                    <form class="newsletter-form" id="newsletterForm">
                        <div class="input-group">
                            <input type="email" class="form-control" placeholder="Email Anda" required>
                            <button class="btn" type="submit">
                                <i class="bi bi-send"></i> Berlangganan
                            </button>
                        </div>
                        <small class="text-white d-block mt-2 opacity-75">Kami tidak akan membagikan email Anda kepada siapapun.</small>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4">
                    <img src="./images/logo.jpg" alt="Logo Kediri Tourism" height="40" class="mb-3">
                    <p class="mb-4">Portal wisata resmi Kota Kediri yang menyediakan informasi lengkap tentang destinasi, kuliner, budaya, dan navigasi real-time.</p>
                    <div class="social-links">
                        <a href="#"><i class="bi bi-facebook"></i></a>
                        <a href="#"><i class="bi bi-instagram"></i></a>
                        <a href="#"><i class="bi bi-twitter-x"></i></a>
                        <a href="#"><i class="bi bi-youtube"></i></a>
                        <a href="#"><i class="bi bi-tiktok"></i></a>
                    </div>
                </div>
                <div class="col-6 col-lg-2">
                    <h5>Menu</h5>
                    <ul class="list-unstyled">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="pages/wisata.html">Wisata</a></li>
                        <li><a href="pages/kuliner.html">Kuliner</a></li>
                        <li><a href="pages/budaya.html">Budaya</a></li>
                        <li><a href="pages/peta.html">Peta</a></li>
                    </ul>
                </div>
                <div class="col-6 col-lg-3">
                    <h5>Informasi</h5>
                    <ul class="list-unstyled">
                        <li><a href="pages/tentang.html">Tentang Kami</a></li>
                        <li><a href="pages/kontak.html">Kontak</a></li>
                        <li><a href="#">Kebijakan Privasi</a></li>
                        <li><a href="#">Syarat & Ketentuan</a></li>
                        <li><a href="#">Bantuan</a></li>
                    </ul>
                </div>
                <div class="col-lg-3">
                    <h5>Kontak</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="bi bi-geo-alt"></i> Jl. Mayor Bismo No.1, Kediri</li>
                        <li class="mb-2"><i class="bi bi-telephone"></i> (0354) 123456</li>
                        <li class="mb-2"><i class="bi bi-envelope"></i> info@kediri-tourism.com</li>
                    </ul>
                </div>
            </div>
            <hr class="my-4 opacity-25">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-start mb-2 mb-md-0">
                    <p class="mb-0">&copy; 2024 Kediri Tourism. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">Made with <i class="bi bi-heart-fill text-danger"></i> for Kediri</p>
                </div>
            </div>
        </div>
    </footer>

    <button id="backToTop" class="back-to-top">
        <i class="bi bi-arrow-up"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        class KediriTourism {
            constructor() {
                this.currentLocation = null;
                this.searchData = [];
                this.theme = localStorage.getItem('theme') || 'light';
                this.searchTimeout = null;
                this.config = {
                    destinations: [],
                    culinary: [],
                    culture: [],
                    events: [],
                    weather: {}
                };
                this.mosques = [
                    { name: "Masjid Agung Kediri", distance: "1.2 km", address: "Jl. Panglima Sudirman" },
                    { name: "Masjid Al-Falah", distance: "2.1 km", address: "Jl. Dhoho" },
                    { name: "Masjid Jami'", distance: "0.8 km", address: "Jl. Veteran" },
                    { name: "Masjid Baiturrahman", distance: "3.5 km", address: "Jl. Yos Sudarso" }
                ];
                this.init();
            }

            async init() {
                await this.loadConfig();
                this.setupTheme();
                this.setupEventListeners();
                this.startRealTimeClock();
                this.renderAll();
                this.setupIntersectionObserver();
                this.loadWeatherData();
                this.loadPrayerTimes();
            }

            async loadConfig() {
                try {
                    const response = await fetch('./config/config-website.json');
                    if (response.ok) {
                        this.config = await response.json();
                    }
                } catch (error) {
                    console.error('Error loading config:', error);
                }
            }

            setupTheme() {
                document.documentElement.setAttribute('data-bs-theme', this.theme);
                const icon = document.querySelector('#themeToggle i');
                icon.className = this.theme === 'dark' ? 'bi bi-sun' : 'bi bi-moon';
            }

            setupEventListeners() {
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.theme = this.theme === 'light' ? 'dark' : 'light';
                    localStorage.setItem('theme', this.theme);
                    this.setupTheme();
                });

                document.getElementById('locationAccess').addEventListener('click', () => {
                    this.requestLocation();
                });

                const searchInput = document.getElementById('searchInput');
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(this.searchTimeout);
                    this.searchTimeout = setTimeout(() => this.handleSearch(e), 300);
                });

                searchInput.addEventListener('focus', () => {
                    if (searchInput.value.length >= 2) {
                        document.getElementById('autocompleteResults').classList.add('show');
                    }
                });

                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-container')) {
                        document.getElementById('autocompleteResults').classList.remove('show');
                    }
                });

                window.addEventListener('scroll', () => {
                    const navbar = document.querySelector('.navbar');
                    const backToTop = document.getElementById('backToTop');
                    
                    if (window.scrollY > 100) {
                        navbar.classList.add('scrolled');
                        backToTop.classList.add('show');
                    } else {
                        navbar.classList.remove('scrolled');
                        backToTop.classList.remove('show');
                    }
                });

                document.getElementById('backToTop').addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });

                document.getElementById('newsletterForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.subscribeNewsletter(e.target.querySelector('input').value);
                    e.target.reset();
                });
            }

            startRealTimeClock() {
                const updateClock = () => {
                    const now = new Date();
                    const options = { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        timeZone: 'Asia/Jakarta'
                    };
                    
                    const dateTime = now.toLocaleDateString('id-ID', options);
                    document.getElementById('realTimeClock').textContent = dateTime;
                    document.getElementById('localTime').textContent = now.toLocaleTimeString('id-ID');
                };

                updateClock();
                setInterval(updateClock, 1000);
            }

            async loadWeatherData() {
                try {
                    const weatherData = {
                        temperature: 28 + Math.floor(Math.random() * 5),
                        condition: "Cerah Berawan",
                        humidity: 65 + Math.floor(Math.random() * 10),
                        windSpeed: 8 + Math.floor(Math.random() * 8)
                    };

                    this.updateWeatherDisplay(weatherData);
                } catch (error) {
                    console.error('Error loading weather data:', error);
                    this.updateWeatherDisplay({
                        temperature: 28,
                        condition: "Cerah Berawan",
                        humidity: 65,
                        windSpeed: 12
                    });
                }
            }

            updateWeatherDisplay(data) {
                document.getElementById('currentTemp').textContent = `${data.temperature}Â°C`;
                document.getElementById('weatherCondition').textContent = data.condition;
                document.getElementById('humidity').textContent = `${data.humidity}%`;
                document.getElementById('windSpeed').textContent = `${data.windSpeed} km/jam`;

                const weatherIcon = document.getElementById('weatherIcon');
                if (data.temperature > 30) {
                    weatherIcon.className = 'bi bi-thermometer-sun text-warning';
                } else if (data.temperature > 25) {
                    weatherIcon.className = 'bi bi-cloud-sun text-info';
                } else {
                    weatherIcon.className = 'bi bi-cloud text-primary';
                }
            }

            async loadPrayerTimes() {
                try {
                    const today = new Date();
                    const prayerTimes = {
                        fajr: "04:15",
                        dhuhr: "11:45",
                        asr: "15:00",
                        maghrib: "17:45",
                        isha: "19:00"
                    };

                    this.updatePrayerTimesDisplay(prayerTimes, today);
                } catch (error) {
                    console.error('Error loading prayer times:', error);
                }
            }

            updatePrayerTimesDisplay(times, date) {
                document.getElementById('fajrTime').textContent = times.fajr;
                document.getElementById('dhuhrTime').textContent = times.dhuhr;
                document.getElementById('asrTime').textContent = times.asr;
                document.getElementById('maghribTime').textContent = times.maghrib;
                document.getElementById('ishaTime').textContent = times.isha;

                const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('prayerDate').textContent = date.toLocaleDateString('id-ID', dateOptions);
            }

            renderAll() {
                const destinations = Array.isArray(this.config.destinations) ? this.config.destinations : [];
                const culinary = Array.isArray(this.config.culinary) ? this.config.culinary : [];
                const culture = Array.isArray(this.config.culture) ? this.config.culture : [];

                this.searchData = [...destinations, ...culinary, ...culture];

                this.renderDestinations(destinations.slice(0, 4));
                this.renderCulinary(culinary.slice(0, 4));
                this.renderCulture(culture);
            }

            renderDestinations(data) {
                const grid = document.getElementById('destinationsGrid');
                if (!grid || !data.length) {
                    grid.innerHTML = '<div class="col-12 text-center"><p>Data destinasi tidak tersedia</p></div>';
                    return;
                }

                grid.innerHTML = data.map(item => `
                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-img-wrapper">
                                <img src="${item.image || './images/default.jpg'}" class="card-img-top" alt="${item.name}" loading="lazy">
                                <span class="card-badge">${item.category || 'Wisata'}</span>
                                <div class="card-rating">
                                    <i class="bi bi-star-fill text-warning"></i>
                                    ${item.rating || '4.5'}
                                </div>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">${item.name}</h5>
                                <p class="card-text">${item.description || 'Destinasi wisata menarik di Kediri'}</p>
                                <div class="card-meta">
                                    <span class="card-meta-item">
                                        <i class="bi bi-geo-alt"></i>
                                        ${item.distance || '2.5 km'}
                                    </span>
                                    <span class="card-meta-item">
                                        <i class="bi bi-tag"></i>
                                        ${item.price || 'Gratis'}
                                    </span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <a href="pages/wisata.html" class="btn btn-primary btn-sm w-100">
                                    Lihat Detail <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            renderCulinary(data) {
                const grid = document.getElementById('culinaryGrid');
                if (!grid || !data.length) {
                    grid.innerHTML = '<div class="col-12 text-center"><p>Data kuliner tidak tersedia</p></div>';
                    return;
                }

                grid.innerHTML = data.map(item => `
                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-img-wrapper">
                                <img src="${item.image || './images/default.jpg'}" class="card-img-top" alt="${item.name}" loading="lazy">
                                <div class="card-rating">
                                    <i class="bi bi-star-fill text-warning"></i>
                                    ${item.rating || '4.5'}
                                </div>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">${item.name}</h5>
                                <p class="card-text">${item.description || 'Kuliner khas Kediri yang lezat'}</p>
                                <div class="mt-3">
                                    <span class="badge bg-primary">${item.price || 'Rp 15.000'}</span>
                                </div>
                            </div>
                            <div class="card-footer">
                                <a href="pages/kuliner.html" class="btn btn-primary btn-sm w-100">
                                    Lihat Lokasi <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            renderCulture(data) {
                const grid = document.getElementById('cultureGrid');
                if (!grid || !data.length) {
                    grid.innerHTML = '<div class="col-12 text-center"><p>Data budaya tidak tersedia</p></div>';
                    return;
                }

                grid.innerHTML = data.map(item => `
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-img-wrapper">
                                <img src="${item.image || './images/default.jpg'}" class="card-img-top" alt="${item.name}" loading="lazy">
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">${item.name}</h5>
                                <p class="card-text">${item.description || 'Budaya dan tradisi khas Kediri'}</p>
                                <span class="badge bg-secondary">${item.category || 'Budaya'}</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            requestLocation() {
                if (!navigator.geolocation) {
                    this.showToast('Browser tidak mendukung geolocation', 'error');
                    return;
                }

                this.showToast('Mendeteksi lokasi...', 'info');

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        this.currentLocation = position.coords;
                        const nearestMosque = this.findNearestMosque();
                        
                        document.getElementById('currentLocation').textContent = 'Kota Kediri, Jawa Timur';
                        document.getElementById('nearestMosque').textContent = `${nearestMosque.name} (${nearestMosque.distance})`;
                        
                        this.showToast('Lokasi terdeteksi!', 'success');
                    },
                    (error) => {
                        let message = 'Tidak dapat mengakses lokasi';
                        if (error.code === error.PERMISSION_DENIED) {
                            message = 'Akses lokasi ditolak';
                        }
                        this.showToast(message, 'error');
                    }
                );
            }

            findNearestMosque() {
                const randomMosque = this.mosques[Math.floor(Math.random() * this.mosques.length)];
                return randomMosque;
            }

            handleSearch(e) {
                const query = e.target.value.toLowerCase().trim();
                const results = document.getElementById('autocompleteResults');

                if (query.length < 2) {
                    results.classList.remove('show');
                    return;
                }

                const filtered = this.searchData.filter(item =>
                    item.name?.toLowerCase().includes(query) ||
                    item.description?.toLowerCase().includes(query) ||
                    item.category?.toLowerCase().includes(query)
                ).slice(0, 5);

                if (filtered.length === 0) {
                    results.innerHTML = '<div class="autocomplete-item">Tidak ada hasil ditemukan</div>';
                } else {
                    results.innerHTML = filtered.map(item => `
                        <div class="autocomplete-item">
                            <img src="${item.image || './images/default.jpg'}" alt="${item.name}">
                            <div class="autocomplete-item-info">
                                <h6>${item.name}</h6>
                                <small>${item.category}</small>
                            </div>
                        </div>
                    `).join('');
                }

                results.classList.add('show');
            }

            subscribeNewsletter(email) {
                this.showToast('Terima kasih telah berlangganan!', 'success');
            }

            showToast(message, type = 'info') {
                const container = document.getElementById('toastContainer');
                const toast = document.createElement('div');
                toast.className = `toast-notification ${type}`;
                
                const icons = {
                    success: 'check-circle-fill',
                    error: 'x-circle-fill',
                    info: 'info-circle-fill'
                };

                toast.innerHTML = `
                    <i class="bi bi-${icons[type]} fs-4 text-${type === 'error' ? 'danger' : type}"></i>
                    <span>${message}</span>
                `;

                container.appendChild(toast);

                setTimeout(() => {
                    toast.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }

            setupIntersectionObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('revealed');
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('.scroll-reveal').forEach(el => {
                    observer.observe(el);
                });
            }
        }

        window.scrollToSection = function(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        };

        document.addEventListener('DOMContentLoaded', () => {
            window.kediriTourism = new KediriTourism();
        });
    </script>
</body>
</html>